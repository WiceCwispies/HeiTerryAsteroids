from fuzzy_asteroids.fuzzy_asteroids import TrainerEnvironment
import numpy as np
from sample_score import SampleScore
from GA.chromosome import Chromosome
from HeiTerryController2 import FuzzyController
from fuzzy_asteroids.fuzzy_asteroids import AsteroidGame, FuzzyAsteroidGame
from fuzzy_asteroids.util import Scenario

# [[2, 2, 2, 1, 0, 0, 1, 2, 0, 2, 1, 0, 2, 0, 0, 2, 0, 0, 2, 2, 0, 0, 0, 2, 2, 1, 2, 0, 0, 2, 1, 2, 0, 2, 2, 0, 2, 1, 0, 0, 0, 2, 1, 1, 0, 1, 0, 2, 1, 0, 1, 1, 1, 1], [2, 2, 1, 2, 1, 2, 0, 1, 1, 0, 2, 1, 0, 0, 2, 2, 2, 1, 0, 1, 0, 1, 1, 1, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 0, 1, 2, 0, 1, 0, 2, 0, 0, 2, 1, 2, 2, 0, 2, 2, 2, 2, 2]]
# fitness: 41.8

# chrom = [[2, 2, 0, 0, 1, 0, 1, 2, 0, 2, 1, 0, 0, 0, 2, 0, 0, 2, 2, 1, 1, 0, 2, 2, 2, 2, 2, 1, 1, 1, 2, 0, 1, 2, 0, 2, 2, 1, 2, 2, 0, 2, 0, 2, 2, 2, 1, 2, 1, 1, 1, 2, 2, 1], [0, 1, 2, 0, 1, 1, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 0, 2, 0, 0, 2, 2, 1, 0, 2, 2, 2, 0, 1, 0, 1, 0, 1, 0, 0, 0, 2, 0, 0, 1, 2, 0, 2, 2, 1, 1, 1, 2, 0, 1, 1, 0, 0, 1]]
# fitness: 38.56666666666667

# [[2, 2, 2, 0, 0, 1, 1, 2, 1, 1, 2, 1, 0, 1, 2, 2, 0, 0, 2, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 1, 2, 1, 2, 1, 1, 0, 0, 1, 2, 0, 0, 2, 0, 2, 1, 0, 0, 0, 1, 1, 2, 0], [0, 1, 0, 1, 0, 1, 1, 2, 0, 0, 2, 1, 1, 0, 0, 0, 1, 0, 1, 2, 1, 2, 0, 2, 2, 2, 1, 1, 0, 2, 0, 0, 0, 1, 0, 0, 0, 1, 2, 2, 2, 0, 0, 2, 1, 0, 2, 1, 0, 2, 1, 1, 0, 0]]
# fitness: 35.7

#chrom = [[2, 0, 0, 2, 1, 1, 1, 2, 1, 1, 0, 2, 2, 2, 1, 2, 1, 0, 1, 1, 0, 1, 2, 1, 0, 0, 2, 0, 2, 0, 2, 1, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 0, 0, 2, 2, 0, 1, 0, 1, 2, 2, 0], [2, 2, 0, 2, 2, 2, 0, 2, 1, 2, 0, 1, 0, 2, 2, 1, 0, 2, 0, 1, 1, 2, 1, 1, 2, 0, 1, 1, 2, 1, 2, 0, 0, 0, 1, 2, 1, 1, 0, 0, 2, 2, 0, 0, 2, 2, 0, 0, 1, 1, 1, 2, 2, 1]]
# fitness: 41.11666666666667

#chrom = [[1, 0, 2, 0, 1, 1, 0, 1, 0, 0, 2, 1, 2, 1, 2, 1, 0, 0, 0, 0, 2, 2, 2, 1, 0, 0, 2, 2, 2, 2, 0, 1, 0, 0, 1, 1, 2, 2, 1, 2, 1, 1, 1, 2, 0, 2, 1, 0, 1, 2, 2, 1, 0, 0], [1, 1, 0, 0, 0, 1, 2, 0, 2, 2, 0, 2, 1, 0, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 0, 1, 0, 2, 2, 2, 2, 2, 0, 0, 1, 2, 1, 1, 0, 2, 2, 2, 0, 1, 0, 0, 1, 0, 0, 2, 1, 1, 1, 1]]
#fitness: 39.18333333333333

# GOOOD
#chrom = [[1, 0, 2, 0, 1, 1, 0, 1, 0, 0, 2, 1, 2, 1, 2, 1, 0, 0, 0, 0, 2, 2, 2, 1, 0, 0, 2, 2, 2, 2, 0, 1, 0, 0, 1, 1, 2, 2, 1, 2, 1, 1, 1, 2, 0, 2, 1, 0, 1, 2, 2, 1, 0, 0], [1, 1, 0, 0, 0, 1, 2, 0, 2, 2, 0, 2, 1, 0, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 0, 1, 0, 2, 2, 2, 2, 2, 0, 0, 1, 2, 1, 1, 0, 2, 2, 2, 0, 1, 0, 0, 1, 0, 0, 2, 1, 1, 1, 1]]
# fitness: 62.1

# GREAATT
#chrom = [[1, 0, 2, 0, 1, 1, 0, 1, 0, 0, 2, 1, 2, 1, 2, 1, 0, 0, 0, 0, 2, 2, 2, 1, 0, 0, 2, 2, 2, 2, 0, 1, 0, 0, 1, 1, 2, 2, 1, 2, 1, 1, 1, 2, 0, 2, 1, 0, 1, 2, 2, 1, 0, 0], [1, 1, 0, 0, 0, 1, 2, 0, 2, 2, 0, 2, 1, 0, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 0, 1, 0, 2, 2, 2, 2, 2, 0, 0, 1, 2, 1, 1, 0, 2, 2, 2, 0, 1, 0, 0, 1, 0, 0, 2, 1, 1, 1, 1]]
# fitness: 71.15
#chrom =  [[1, 0, 2, 0, 1, 1, 0, 1, 0, 0, 2, 1, 2, 1, 2, 1, 0, 0, 0, 0, 2, 2, 2, 1, 0, 0, 2, 2, 2, 2, 0, 1, 0, 0, 1, 1, 2, 2, 1, 2, 1, 1, 1, 2, 0, 2, 1, 0, 1, 2, 2, 1, 0, 0], [1, 1, 0, 0, 0, 1, 2, 0, 2, 2, 0, 2, 1, 0, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 0, 1, 0, 2, 2, 2, 2, 2, 0, 0, 1, 2, 1, 1, 0, 2, 2, 2, 0, 1, 0, 0, 1, 0, 0, 2, 1, 1, 1, 1]]
#chrom = [[2, 1, 1, 0, 2, 2, 0, 2, 2, 0, 2, 2, 0, 2, 0, 1, 2, 1, 0, 1, 1, 2, 0, 1, 0, 2, 2, 2, 2, 1, 1, 2, 0, 2, 1, 1, 1, 0, 0, 0, 2, 1, 2, 0, 0, 2, 0, 1, 2, 2, 0, 2, 2, 2], [2, 1, 2, 1, 0, 0, 1, 1, 0, 1, 1, 2, 2, 0, 2, 2, 2, 1, 1, 2, 0, 2, 0, 1, 0, 2, 1, 1, 1, 1, 2, 0, 0, 2, 0, 0, 1, 0, 2, 0, 0, 1, 1, 1, 1, 0, 2, 0, 1, 2, 1, 2, 0, 1]]
#fitness: 104.53333333333333

chrom = [[1, 2, 0, 1, 0, 1, 1, 0, 0, 0, 2, 0, 2, 2, 0, 2, 0, 0, 1, 0, 1, 2, 0, 2], [1, 1, 1, 0, 0, 1, 1, 2, 0, 0, 1, 0, 1, 1, 2, 1, 2, 1, 0, 2, 2, 1, 1, 1]]
#fitness: 84.08333333333333
chrom = [[1, 1, 1, 0, 1, 2, 1, 2, 0, 1, 1, 1, 2, 1, 2, 2, 1, 1, 2, 2, 2, 0, 2, 0], [0, 1, 0, 2, 1, 1, 0, 1, 1, 2, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 2, 2, 1]]
#fitness: 80.1

chrom = [[1, 0, 2, 2, 1, 2, 1, 2, 0, 2, 2, 2, 1, 0, 2, 1, 1, 2, 1, 1, 2, 1, 0, 2], [1, 2, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 2, 0, 1, 2, 0, 2, 2, 0, 0, 2, 1]]
#fitness: 15.783333333333333
if __name__ == "__main__":
    # Available settings
    settings = {
        # "frequency": 60,
        # "lives": 3,
        # "prints": False,
    }
    """chromosome = [[0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 2, 2, 1, 2, 1, 0, 0, 1, 2, 1, 0, 2, 1, 2, 1, 2, 2, 1, 0, 2, 2, 0, 0, 1, 0,
      0, 2, 1, 2, 0, 1, 1, 1, 2, 1, 1, 1, 2, 2, 2, 2],
     [2, 0, 2, 0, 2, 1, 0, 2, 1, 2, 2, 0, 1, 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 2, 2, 0, 2, 0, 0, 1, 2, 0, 0, 1, 1, 0, 2, 0,
      1, 2, 2, 0, 2, 0, 0, 0, 2, 0, 1, 0, 2, 2, 2, 0]]"""
    chromosome = [
        [1, 0, 2, 2, 1, 0, 0, 2, 2, 0, 0, 1, 1, 1, 0, 1, 2, 2, 2, 2, 2, 2, 2, 0, 1, 1, 2, 2, 0, 0, 2, 2, 0, 1, 1, 1, 1,
         1, 1, 0, 2, 0, 2, 2, 1, 2, 0, 1, 0, 2, 0, 0, 0, 2],
        [0, 2, 2, 2, 2, 2, 2, 0, 0, 2, 1, 1, 2, 2, 1, 0, 0, 0, 2, 2, 1, 0, 1, 1, 2, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 2, 2,
         0, 0, 2, 2, 2, 1, 1, 0, 0, 0, 2, 1, 2, 1, 2, 2, 0]]
    """chromosome = [
        [1, 0, 2, 2, 1, 0, 0, 2, 2, 0, 0, 1, 1, 1, 0, 1, 2, 2, 2, 2, 2, 2, 2, 0, 1, 1, 2, 2, 0, 0, 0, 1, 1, 1, 2, 1, 0,
         1, 1, 0, 2, 0, 2, 2, 1, 2, 0, 1, 0, 2, 0, 0, 0, 2],
        [0, 2, 2, 2, 2, 2, 2, 0, 0, 2, 1, 1, 2, 2, 1, 0, 0, 0, 2, 2, 1, 0, 1, 0, 1, 2, 2, 1, 1, 0, 1, 1, 0, 0, 1, 2, 2,
         0, 0, 2, 2, 2, 1, 1, 0, 0, 0, 2, 1, 2, 1, 2, 2, 0]]"""
    chrom = Chromosome(chrom)
    # scenario_ast = Scenario(
    #     asteroid_states=[{"position": (200, 550), "angle": 84.6, "speed": 25},
    #                      {"position": (600, 500), "angle": 169.0, "speed": 40},
    #                      {"position": (700, 200), "angle": 46.8, "speed": 30},
    #                      {"position": (300, 100), "angle": 135.0, "speed": 50},
    #                      {"position": (100, 400), "angle": -26.0, "speed": 42},
    #                      {"position": (500, 200), "angle": -96.0, "speed": 25},
    #                      ]
    # )
    scenario_ast = Scenario(
        asteroid_states=[{"position": (300, 550), "angle": 84.6, "speed": 25},
                         {"position": (500, 500), "angle": 169.0, "speed": 40},
                         {"position": (730, 300), "angle": 90.8, "speed": 60},
                         ]
    )
    # To use the controller within the context of a training solution
    # It is important to not create a new instance of the environment everytime
    game = FuzzyAsteroidGame(settings=settings)
    score = game.run(controller=FuzzyController(chrom), score=SampleScore(), scenario=scenario_ast)
    print(score.time)

